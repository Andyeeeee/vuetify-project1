import{aF as V,aL as x,Y as w,_ as S,x as k,aG as q,a1 as B,ak as C,a2 as F,a3 as $,ac as n,ad as o,c as t,a5 as s,aM as K,a7 as D,V as M,af as u,aa as l,aJ as N,U as P,aK as E,K as p}from"./index-3beb131a.js";import{c as R,e as T,u as U,d as j}from"./index.esm-a4f3b5f8.js";import{b as A,V as G,a as c}from"./VRow-ee2c93ed.js";import"./_commonjsHelpers-39b5b250.js";const I={class:"text-center"},J=u("h1",{class:"text-red"},"已下架",-1),Q={__name:"ProductView",setup(L){const v=R({quantity:T().typeError("缺少數量").required("缺少數量").min(1,"最少為 1")}),{isSubmitting:_,handleSubmit:f}=U({validationSchema:v}),i=j("quantity"),g=f(async a=>{try{const{data:r}=await V.post("/users/cart",{product:d.product.value._id,quantity:a.quantity});b.cart=r.result}catch(r){m({text:r.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),d=x(),m=w(),b=S(),e=k({_id:"",name:"",price:0,description:"",image:"",sell:"",category:""});return(async()=>{try{const{data:a}=await q.get("/products/"+d.params.id);e.value._id=a.result._id,e.value.name=a.result.name,e.value.price=a.result.price,e.value.description=a.result.description,e.value.image=a.result.image,e.value.sell=a.result.sell,e.value.category=a.result.category,document.title="KK | "+e.value.name}catch(a){m({text:a.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})(),(a,r)=>{const y=B("v-from"),h=C("mode");return F(),$(D,null,[n(o(a.$route.params.id)+" ",1),t(A,null,{default:s(()=>[t(G,null,{default:s(()=>[t(c,{cols:"12"},{default:s(()=>[t(M,{src:e.value.image},null,8,["src"])]),_:1}),t(c,{cols:"12"},{default:s(()=>[u("h1",I,o(e.value.name),1)]),_:1}),t(c,{cols:"12"},{default:s(()=>[u("p",null,"$"+o(e.value.price),1),u("pre",null,"$"+o(e.value.description),1),t(y,{disabled:l(_),onSubmit:N(l(g),["prevent"])},{default:s(()=>[P(t(E,{type:"number",label:"數量",min:"0","error-messages":l(i).errorMessage.value},null,8,["error-messages"]),[[h,l(i).value.value,void 0,{number:!0}]]),t(p,{type:"submit",color:"green"},{default:s(()=>[n("加入購物車")]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}),t(K,{"mode-value":!e.value.sell,persistent:"",class:"align-center text-center justify-center"},{default:s(()=>[J,t(p,null,{default:s(()=>[n("回上頁")]),_:1})]),_:1},8,["mode-value"])],64)}}};export{Q as default};
