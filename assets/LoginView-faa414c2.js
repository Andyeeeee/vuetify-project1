import{Y as w,Z as x,_ as y,aJ as k,a2 as S,a3 as B,c as a,a5 as s,V as C,ad as t,aN as F,aO as i,K as d,af as m,aa as o}from"./index-22d0d89d.js";import{_ as N}from"./icon-05a315e1.js";import{c as M,a as p,u as U,d as _}from"./index.esm-c1ac4685.js";import{b as j,a as q,V as L}from"./VRow-c1cb7042.js";import{V as P}from"./VForm-9ab2eae5.js";import"./_commonjsHelpers-39b5b250.js";const R={id:"LoginView"},T=o("div",null," ",-1),$=o("div",null," ",-1),E=o("hr",null,null,-1),I=o("div",null," ",-1),D={__name:"LoginView",setup(J){const c=w(),V=x(),f=y(),g=M({account:p().required("帳號必填").min(4,"帳號最少 4 個字").max(20,"帳號最多 20 個字"),password:p().required("密碼必填").min(4,"密碼最少 4 個字").max(20,"密碼最多 20 個字")}),{handleSubmit:h,isSubmitting:b}=U({validationSchema:g}),r=_("account"),l=_("password"),v=h(async n=>{try{const{data:e}=await k.post("/users/login",{account:n.account,password:n.password});f.login({token:e.result.token,account:e.result.account,email:e.result.email,cart:e.result.cart,role:e.result.role}),c({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),V.push("/")}catch(e){c({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(n,e)=>(S(),B("section",R,[a(j,null,{default:s(()=>[a(C,{width:180,"aspect-ratio":"16/9",cover:"",src:N,style:{margin:"auto"}}),a(q,{cols:"4",style:{margin:"auto"},class:"text-center justify-center"},{default:s(()=>[a(P,{disabled:t(b),onSubmit:F(t(v),["prevent"])},{default:s(()=>[a(i,{modelValue:t(r).value.value,"onUpdate:modelValue":e[0]||(e[0]=u=>t(r).value.value=u),"error-messages":t(r).errorMessage.value,placeholder:"帳號",counter:"",maxlength:"20"},null,8,["modelValue","error-messages"]),a(i,{modelValue:t(l).value.value,"onUpdate:modelValue":e[1]||(e[1]=u=>t(l).value.value=u),"error-messages":t(l).errorMessage.value,placeholder:"密碼",counter:"",maxlength:"20",type:"password"},null,8,["modelValue","error-messages"]),T,a(L,{style:{"justify-content":"space-around"}},{default:s(()=>[a(d,{type:"submit"},{default:s(()=>[m("登入")]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"]),$,E,I,a(d,{to:"/register"},{default:s(()=>[m("註冊會員")]),_:1})]),_:1})]),_:1})]))}};export{D as default};
